(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{13:function(e,t,n){},27:function(e,t,n){},48:function(e,t,n){"use strict";n.r(t);var a=n(1),i=n.n(a),r=n(22),c=n.n(r),s=(n(27),n(3)),d=n.n(s),o=n(4),u=n(5),l=n(6),p=n(11),j=n(10),h=n(7),f=(n(13),n(9)),m=n(0);function b(){var e=Object(a.useState)(""),t=Object(f.a)(e,2),n=t[0],i=t[1],r=Object(a.useState)(0),c=Object(f.a)(r,2),s=c[0],d=c[1],o=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];return Object(a.useEffect)((function(){setTimeout((function(){var e=new Date,t=e.getDate().toPrecision(2)+" "+o[e.getMonth()];i(t),d(s+1)}),1e3)}),[]),Object(a.useEffect)((function(){setTimeout((function(){var e=new Date,t=e.getDate().toPrecision(2)+" "+o[e.getMonth()];i(t),d(s+1)}),6e4)}),[s]),Object(m.jsx)("div",{className:"date",children:n})}function v(e){var t=new Date(1e3*e);return String(t.getHours()).padStart(2,"0")+":"+String(t.getMinutes()).padStart(2,"0")}var O=function(e){Object(p.a)(n,e);var t=Object(j.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={time:0},a.tick=a.tick.bind(Object(l.a)(a)),a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){this.tick()}},{key:"tick",value:function(){var e=new Date,t=String(e.getHours()).padStart(2,"0")+":"+String(e.getMinutes()).padStart(2,"0");e.getSeconds()%2==0&&(t=String(e.getHours()).padStart(2,"0")+" "+String(e.getMinutes()).padStart(2,"0")),this.setState({time:t})}},{key:"componentDidUpdate",value:function(){var e=this;setTimeout((function(){return e.tick()}),1e3)}},{key:"componentWillUnmount",value:function(){}},{key:"render",value:function(){return this.state.time?Object(m.jsx)("div",{className:"time",children:this.state.time}):Object(m.jsx)("div",{})}}]),n}(i.a.Component);function x(e){var t=e.item,n=e.mode,a=e.now,i="portrait"==n?"calendaritem_portrait":"calendaritem_landscape",r=new Date(1e3*t["start-utc-timestamp"]),c=new Date(1e3*t["finish-utc-timestamp"]);if(a>=r&&a<=c){var s=Math.floor(c.getTime()/6e4-a.getTime()/6e4),d="#32a84a";return s<=5?d="#ff0000":s<=10?d="#ff7700":s<=15&&(d="#ffa600"),Object(m.jsxs)("div",{className:"calendaritem "+i,children:[Object(m.jsx)("div",{className:"calendaritem_name",children:t.label}),Object(m.jsx)("div",{className:"calendaritem_start",children:v(t["start-utc-timestamp"])}),Object(m.jsx)("div",{className:"calendaritem_finish",children:v(t["finish-utc-timestamp"])}),Object(m.jsx)("div",{className:"calendaritem_countdown countdown",style:{backgroundColor:d},children:s})]})}return a<=r?Object(m.jsxs)("div",{className:"calendaritem "+i,children:[Object(m.jsx)("div",{className:"calendaritem_name",children:t.label}),Object(m.jsx)("div",{className:"calendaritem_start",children:v(t["start-utc-timestamp"])}),Object(m.jsx)("div",{className:"calendaritem_finish",children:v(t["finish-utc-timestamp"])})]}):Object(m.jsx)("div",{style:{display:"none"}})}function w(e){var t=e.items,n=e.mode,i=Object(a.useState)(new Date),r=Object(f.a)(i,2),c=r[0],s=r[1];Object(a.useEffect)((function(){setTimeout((function(){s(new Date)}),1e3)}),[c]);var d=Math.floor((new Date).getTime()/1e3);return Array.isArray(t)?Object(m.jsx)("div",{className:"calendaritems",children:t.map((function(e,t){if(d<e["finish-utc-timestamp"]&&d+86400>e["start-utc-timestamp"])return Object(m.jsx)(x,{item:e,mode:n,now:c},t)}))}):Object(m.jsx)("div",{})}var g=function(e){Object(p.a)(n,e);var t=Object(j.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={remaining:20},a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){}},{key:"componentWillUnmount",value:function(){}},{key:"render",value:function(){return"landscape"===this.props.mode?Object(m.jsxs)("div",{className:"landscape",children:[Object(m.jsx)(b,{}),Object(m.jsx)(O,{}),Object(m.jsx)(w,{items:this.props.items,mode:"landscape"})]}):Object(m.jsxs)("div",{className:"portrait",children:[Object(m.jsx)(b,{}),Object(m.jsx)(O,{}),Object(m.jsx)(w,{items:this.props.items,mode:"portrait"})]})}}]),n}(i.a.Component),y=n(8),k=n.n(y);function C(){return(C=Object(h.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new FormData).append("file",t),e.next=4,k.a.post("/set_calendar",n,{headers:{"Content-Type":"multipart/form-data"}}).then((function(e){return console.log("uploadCalendar res",e),e.data}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var S=function(e){var t=e.setCalendar,n=Object(a.useState)(""),i=Object(f.a)(n,2),r=i[0],c=i[1],s=Object(a.useState)(""),d=Object(f.a)(s,2),o=d[0],u=d[1];function l(e){(function(e){return C.apply(this,arguments)})(document.querySelector("input[name='calendarfile']").files[0]).then((function(e){e&&e.calendarid&&e.pin?(alert("Calendar successfully imported. To access this calendar in the future use\ncalendarid: "+e.calendarid+"\npin: "+e.pin+"\n\nPlease record these values."),t(e.calendarid,e.pin)):alert("Error importing the calendar")}))}return Object(m.jsxs)("div",{children:[Object(m.jsxs)("fieldset",{children:[Object(m.jsx)("legend",{children:"Upload new calendar"}),Object(m.jsx)("label",{for:"calendarfile",children:"Upload an .ical file"}),Object(m.jsx)("input",{name:"calendarfile",type:"file"}),Object(m.jsx)("input",{name:"upload",type:"button",onClick:function(e){return l()},value:"Upload"})]}),Object(m.jsx)("div",{children:"\xa0"}),Object(m.jsx)("div",{children:"\xa0"}),Object(m.jsxs)("fieldset",{children:[Object(m.jsx)("legend",{children:"Open existing calendar"}),Object(m.jsx)("label",{for:"calendarid",children:"Calendar ID"}),Object(m.jsx)("input",{name:"calendarid",type:"text",value:r,onChange:function(e){return c(e.target.value)}}),Object(m.jsx)("label",{for:"calendarid",children:"PIN code"}),Object(m.jsx)("input",{name:"pin",type:"password",value:o,onChange:function(e){return u(e.target.value)}}),Object(m.jsx)("input",{name:"load",type:"button",onClick:function(e){t(r,o)},value:"Load"})]})]})},D=function(){function e(){Object(o.a)(this,e),this.url=""}return Object(u.a)(e,[{key:"getCalendar",value:function(){var e=Object(h.a)(d.a.mark((function e(t,n){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={calendarid:t,pin:n},e.next=3,k.a.post(this.url+"/get_calendar",a).then((function(e){return e.data}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"setCalendar",value:function(){var e=Object(h.a)(d.a.mark((function e(t,n,a){var i;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return{calendarid:t,pin:n},(i=new FormData).append("file",a),i.append("calendarid",t),i.append("pin",n),e.next=7,k.a.post(this.url+"/set_calendar",i,{headers:{"Content-Type":"multipart/form-data"}}).then((function(e){return console.log("DataProvider/setCalendar res",e),e.data}));case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n,a){return e.apply(this,arguments)}}()}]),e}();function N(e,t){return M.apply(this,arguments)}function M(){return(M=Object(h.a)(d.a.mark((function e(t,n){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={calendarid:t,pin:n},e.next=3,k.a.post("/get_calendar",a).then((function(e){return e.data}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var _=function(e){Object(p.a)(n,e);var t=Object(j.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={calendarid:"",pin:"",previousCalendar:"",data:null,mode:"display",w:window.screen.width,h:window.screen.height,orientation:window.innerWidth>window.innerHeight?"landscape":"portrait"},a.data=new D,a.setScreenOrientation=a.setScreenOrientation.bind(Object(l.a)(a)),a.setCalendar=a.setCalendar.bind(Object(l.a)(a)),a}return Object(u.a)(n,[{key:"setScreenOrientation",value:function(){this.setState({w:window.screen.width,h:window.screen.height,orientation:window.innerWidth>window.innerHeight?"landscape":"portrait"})}},{key:"componentDidMount",value:function(){var e=this;window.addEventListener("resize",(function(){return e.setScreenOrientation()})),this.ticktocker=setInterval((function(){N(e.state.calendarid,e.state.pin).then((function(t){t&&t.data&&e.setState({data:t.data,previousCalendar:e.state.calendarid})}))}),36e5)}},{key:"componentWillUnmount",value:function(){clearInterval(this.ticktocker)}},{key:"componentDidUpdate",value:function(){var e=this;""===this.state.calendarid||""===this.state.pin||this.state.calendarid===this.state.previousCalendar&&""!==this.state.previousCalendar||N(this.state.calendarid,this.state.pin).then((function(t){t&&t.data&&e.setState({data:t.data,previousCalendar:e.state.calendarid})}))}},{key:"setCalendar",value:function(e,t){this.setState({calendarid:e,pin:t,previousCalendar:""})}},{key:"render",value:function(){return console.log(this.state.calendarid),""===this.state.calendarid?Object(m.jsx)(S,{setCalendar:this.setCalendar}):"display"===this.state.mode&&"landscape"===this.state.orientation?Object(m.jsx)(g,{mode:"landscape",items:this.state.data}):"display"===this.state.mode&&"portrait"===this.state.orientation?Object(m.jsx)(g,{mode:"portrait",items:this.state.data}):Object(m.jsx)(S,{setCalendar:this.setCalendar})}}]),n}(i.a.Component),T=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,49)).then((function(t){var n=t.getCLS,a=t.getFID,i=t.getFCP,r=t.getLCP,c=t.getTTFB;n(e),a(e),i(e),r(e),c(e)}))};c.a.render(Object(m.jsx)(i.a.StrictMode,{children:Object(m.jsx)(_,{})}),document.getElementById("root")),T()}},[[48,1,2]]]);
//# sourceMappingURL=main.9c5e3551.chunk.js.map